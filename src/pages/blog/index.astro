---
import BaseLayout from '../../layouts/BaseLayout.astro';
import NavBar from '../../components/NavBar.astro';
import Footer from '../../components/Footer.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime()
);
---
<BaseLayout title="Xavier Jodoin â€” Blog" description="Writing about AI products, engineering process, and the lessons drawn from everyday experiments.">
  <NavBar />
  <main id="main" class="blog-index">
    <div class="container">
      <header class="blog-index__header">
        <p class="blog-index__eyebrow">Blog</p>
        <h1>From the build log</h1>
        <p class="lead">Notes on AI product strategy, developer tools, and the slow thinking that keeps teams grounded.</p>
      </header>
      <div class="blog-index__list">
        {posts.map((post, index) => (
          <article class="blog-index__item glass" style={`--delay: ${index * 0.08}s`}>
            <header class="blog-index__item-header">
              <time class="blog-index__date" datetime={post.data.publishDate.toISOString()}>
                {post.data.publishDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
              </time>
              <ul class="blog-index__tags">
                {post.data.tags.slice(0, 2).map((tag) => (
                  <li>{tag}</li>
                ))}
              </ul>
            </header>
            <h2>
              <a href={`/blog/${post.slug}/`}>{post.data.title}</a>
            </h2>
            <p>{post.data.description}</p>
            <a href={`/blog/${post.slug}/`} class="blog-index__read-more">
              <span>Read article</span>
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true">
                <path d="M6 3L11 8L6 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </a>
          </article>
        ))}
      </div>
    </div>
  </main>
  <Footer />
</BaseLayout>

<style>
  .blog-index {
    padding-block: clamp(var(--space-12), 8vw, var(--space-20));
    min-height: 60vh;
  }

  .blog-index__header {
    text-align: center;
    max-width: 720px;
    margin-inline: auto;
    margin-bottom: var(--space-16);
  }

  .blog-index__eyebrow {
    font-size: var(--type-sm);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: var(--color-primary);
    margin-bottom: var(--space-4);
  }

  .blog-index__header h1 {
    font-size: clamp(var(--type-3xl), 5vw, var(--type-5xl));
    font-weight: 700;
    letter-spacing: -0.03em;
    margin-bottom: var(--space-4);
    background: linear-gradient(135deg, var(--color-text) 0%, var(--color-text-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .blog-index__header .lead {
    margin-inline: auto;
  }

  .blog-index__list {
    display: grid;
    gap: var(--space-6);
    max-width: 800px;
    margin-inline: auto;
  }

  .blog-index__item {
    padding: var(--space-8);
    border-radius: var(--radius-2xl);
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    animation: fadeInUp 0.6s var(--ease-out) var(--delay, 0s) backwards;
  }

  .blog-index__item-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-4);
    flex-wrap: wrap;
  }

  .blog-index__date {
    color: var(--color-muted);
    font-size: var(--type-sm);
    font-weight: 500;
  }

  .blog-index__item h2 {
    margin: 0;
    font-size: var(--type-xl);
    font-weight: 600;
    letter-spacing: -0.02em;
    line-height: 1.3;
  }

  .blog-index__item h2 a {
    color: var(--color-text);
    text-decoration: none;
    transition: color var(--duration-fast) var(--ease-out);
  }

  .blog-index__item h2 a:hover {
    color: var(--color-primary);
  }

  .blog-index__item h2 a:visited {
    color: var(--color-text);
  }

  .blog-index__item p {
    color: var(--color-text-secondary);
    line-height: 1.6;
    margin: 0;
  }

  .blog-index__tags {
    list-style: none;
    display: flex;
    gap: var(--space-2);
    padding: 0;
    margin: 0;
  }

  .blog-index__tags li {
    padding: var(--space-1) var(--space-3);
    border-radius: var(--radius-full);
    background: rgba(0, 113, 227, 0.08);
    color: var(--color-primary);
    font-size: var(--type-xs);
    font-weight: 500;
  }

  .blog-index__read-more {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--type-sm);
    font-weight: 600;
    color: var(--color-primary);
    text-decoration: none;
    margin-top: auto;
    transition: gap var(--duration-fast) var(--ease-out);
  }

  .blog-index__read-more:visited {
    color: var(--color-primary);
  }

  .blog-index__read-more:hover {
    gap: var(--space-3);
  }

  .blog-index__read-more svg {
    transition: transform var(--duration-fast) var(--ease-out);
  }

  .blog-index__read-more:hover svg {
    transform: translateX(3px);
  }
</style>
